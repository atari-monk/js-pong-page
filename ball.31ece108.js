var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},s={},e={},i=t.parcelRequire3f2e;null==i&&((i=function(t){if(t in s)return s[t].exports;if(t in e){var i=e[t];delete e[t];var n={id:t,exports:{}};return s[t]=n,i.call(n.exports,n,n.exports),n.exports}var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(t,s){e[t]=s},t.parcelRequire3f2e=i),i("3gXC5"),i("ic7rk"),i("9NZOq");class n{constructor(t,s){this.x=t,this.y=s}mag(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){const t=this.mag(),s=new n;return s.x=this.x/t,s.y=this.y/t,s}log(){console.log(`(${this.x}, ${this.y})`)}}class a{#t;constructor(t,s,e,i,a,o,l,r){this.gameSize=t,this.position=s,this.#t=new n(s.x,s.y),this.size=e,this.speed=i,this.inputHandler=a,this.render=o,this.printer=l,this.textPos=r,this.color="green",this.infoColor="white",this.name="entity"}update(t){this.inputHandler.handleInput(this),this.position.y-=t.deltaTime*this.speed.y,this.#s()}reverseXSpeed(){this.speed.x*=-1}reverseYSpeed(){this.speed.y*=-1}#s(){this.position.y<=this.size.y/2&&(this.position.y=this.size.y/2),this.position.y>=this.gameSize.y-this.size.y/2&&(this.position.y=this.gameSize.y-this.size.y/2)}reset(){this.position.x=this.#t.x,this.position.y=this.#t.y,this.speed.x=0,this.speed.y=0}draw(t){this.render.draw(t,this),this.drawInfo()}drawInfo(){const t=this.printer,s=this.getInfo();for(let e=0;e<s.length;e++)t?.print(`${s[e].join("   ")}`,this.textPos.x,this.textPos.y+40*e+40,this.infoColor)}getInfo(){return[[`${this.name} - size (${this.size.x.toFixed(0)}, ${this.size.y.toFixed(0)}), vel (${this.speed.x.toFixed(2)}, ${this.speed.y.toFixed(2)}), pos (${this.position.x.toFixed(0)}, ${this.position.y.toFixed(0)})`]]}}class o extends a{constructor(t,s,e,i,n,a,o,l){super(t,s,e,i,n,a.graphics,o,l)}draw(t){this.renderers.graphics.draw(t,this)}drawText(t){this.renderers.text.draw(t,this)}}class l extends o{constructor(t,s,e,i,n,a,o,l,r){super(t,s,e,i,n,a.graphics,o,l,r),this.name="Ball",this.wallCollision=r,this.renderers=a}update(t){this.inputHandler?.handleInput(this),this.#e(t),this.wallCollision?.calculateCollision(this)}#e(t){this.position.x+=t.deltaTime*this.speed.x,this.position.y+=t.deltaTime*this.speed.y}getInfo(){const t=super.getInfo();return t[0][0]=t[0][0].concat(`, wall (${this.wallCollision.log})`),t}}class r{constructor(t){this.gameFactory=t,this.screen=t.screen,this.timer=this.gameFactory.timer,this.input=this.gameFactory.input,this.ball=this.gameFactory.ball,this.player1=this.gameFactory.player1,this.player2=this.gameFactory.player2,this.collisionLeft=this.gameFactory.collisionLeft,this.collisionLeftRender=this.gameFactory.collisionLeftRender,this.collisionRight=this.gameFactory.collisionRight,this.collisionRightRender=this.gameFactory.collisionRightRender,this.printer=this.gameFactory.printer,this.pointCount=this.gameFactory.pointCount,this.name="Game"}update(t){this.timer.set(t),null!=this.ball&&this.ball.update(this.timer),null!=this.player1&&this.player1.update(this.timer),null!=this.player2&&this.player2.update(this.timer),null!=this.collisionLeft&&null!=this.ball&&null!=this.player1&&this.collisionLeft.calculateCollision(this.player1,this.ball),null!=this.collisionRight&&null!=this.ball&&null!=this.player2&&this.collisionRight.calculateCollision(this.player2,this.ball),this.pointCount?.update()}draw(){this._clearCtx(),null!=this.ball&&this.ball.draw(this.screen.gameCtx),null!=this.player1&&this.player1.draw(this.screen.gameCtx),null!=this.player2&&this.player2.draw(this.screen.gameCtx),null!=this.collisionLeftRender&&this.collisionLeftRender.draw(),null!=this.collisionRightRender&&this.collisionRightRender.draw(),this.collisionLeft?.draw(),this.collisionRight?.draw(),this.pointCount?.draw(),this._drawPoints(this.screen.gameCtx),this.ball instanceof l&&this.ball?.drawText(this.screen.textCtx),this._print()}_clearCtx(){this.screen.gameCtx.clearRect(0,0,this.screen.gameSize.x,this.screen.gameSize.y),this.screen.textCtx.clearRect(0,0,this.screen.textSize.x,this.screen.textSize.y)}_print(){const t=this.printer,s=this.getInfo();for(let e=0;e<s.length;e++)t?.print(`${s[e].join("     ")}`,5,20+40*e,this.infoColor)}getInfo(){return[["test"]]}_drawPoints(t,s=!1){s&&(t.fillStyle="white",t.fillRect(this.screen.gameSize.x/2-.5,this.screen.gameSize.y/2-.5,1,1))}}class h{constructor(){this.deltaTime=0,this.lastTime=0}set(t){const s=t-this.lastTime;s<20&&(this.deltaTime=s),this.lastTime=t}log(){console.log(this.deltaTime)}}class c extends a{constructor(t,s,e,i,n,a,o,l,r){super(t,s,e,i,n,a,o,l),this.name="Ball",this.wallCollision=r}update(t){this.inputHandler?.handleInput(this),this.#e(t),this.wallCollision.calculateCollision(this)}#e(t){this.position.x+=t.deltaTime*this.speed.x,this.position.y+=t.deltaTime*this.speed.y}getInfo(){const t=super.getInfo();return t[0][0]=t[0][0].concat(`, wall (${this.wallCollision.log})`),t}}class d{draw(t,s){if(s.size.x!=s.size.y)throw"This collider works only for rectangles!";this.#i(t,s),this.#n(t,s)}#i(t,s){var e=s.size.x;t.fillStyle="green",t.fillRect(s.position.x-e/2,s.position.y-e/2,e,e)}#n(t,s){t.fillStyle="yellow",t.fillRect(s.position.x-2.5,s.position.y-2.5,5,5)}}class p{constructor(){this.log=""}calculateCollision(t){if(t.size.x!=t.size.y)throw"This collider works only for rectangles!";const s=t.size.x/2,e=t.gameSize;t.position.x<=s&&(t.position.x=s,this.log="left",t.reverseXSpeed()),t.position.x>=e.x-s&&(t.position.x=e.x-s,this.log="right",t.reverseXSpeed()),t.position.y<=s&&(t.position.y=s,this.log="top",t.reverseYSpeed()),t.position.y>=e.y-s&&(t.position.y=e.y-s,this.log="bottom",t.reverseYSpeed())}}class y{constructor(t){this.ctx=t,this.setPrint("left","normal 12px Arial")}setPrint(t,s){this.ctx.textAlign=t,this.ctx.font=s}print(t,s,e,i){this.ctx.fillStyle=i,this.ctx.fillText(t,s,e)}printInLines(t,s,e,i,n){let a=n;t.forEach((t=>{this.print(t,i,a,s),a+=e}))}}class g{constructor(){this.keys=[],window.addEventListener("keydown",(t=>{"ArrowDown"!==t.key&&"ArrowUp"!==t.key&&"ArrowLeft"!==t.key&&"ArrowRight"!==t.key||-1!==this.keys.indexOf(t.key)||this.keys.push(t.key)})),window.addEventListener("keyup",(t=>{"ArrowDown"!==t.key&&"ArrowUp"!==t.key&&"ArrowLeft"!==t.key&&"ArrowRight"!==t.key||this.keys.splice(this.keys.indexOf(t.key),1)}))}}class u{constructor(t){this.input=t}handleInput(t){t.speed.x>0&&this.#a("ArrowLeft")||t.speed.x<0&&this.#a("ArrowRight")?this.#o(t):(t.speed.y>0&&this.#a("ArrowUp")||t.speed.y<0&&this.#a("ArrowDown"))&&this.#l(t)}#a(t){return this.input.keys.indexOf(t)>-1}#l(t){t.speed.y=-t.speed.y}#o(t){t.speed.x=-t.speed.x}}class w{#r;#h;#c;#d;constructor(t,s){this.#r=t,this.#h=s}get canvasId(){return this.#r}get size(){return this.#h}get canvas(){return this.#c}get ctx(){return this.#d}setCanvas(){this.#c=document.getElementById(this.#r),this.#c.width=this.#h.x,this.#c.height=this.#h.y,this.#d=this.#c.getContext("2d")}}const m="hide",x="select-controls-player",v="menu-container",f="btn-start",C="btn-reset",b="btn-overlay";(new class{#p;#y;#g;#u;#w;#m;#x;static get hide(){return m}static get selectGame(){return"select-controls-game"}static get selectPlayer(){return x}static get menuContainer(){return v}static get btnStart(){return f}static get btnReset(){return C}static get btnOverlay(){return b}constructor(t){this.#x=t,this.#p=document.getElementById(v),this.#y=document.getElementById("menu-btns"),this.#g=document.getElementById(f),this.#u=document.getElementById(C),this.#w=document.getElementById(b),this.#v(),this.#m=document.getElementById("select-controls-container")}#v(){HTMLSelectElement.prototype.__defineGetter__("val",(function(){return this.options[this.selectedIndex].value})),HTMLSelectElement.prototype.__defineGetter__("text",(function(){return this.options[this.selectedIndex].text}))}setPlayerView(t){this.#x(this.#m.childNodes[3].val),this.#g.classList.add(m),this.#u.classList.add(m),this.#w.classList.add(m),this.#m.classList.add(x),this.#f(t)}setGameView(){this.#p.classList.remove(m),this.#y.classList.remove(m),this.#g.classList.remove(m),this.#u.classList.remove(m),this.#w.classList.remove(m)}hide(){this.#g.classList.add(m),this.#u.classList.add(m),this.#w.classList.add(m),this.#m.classList.add(m)}#f(){this.#m.addEventListener("change",(t=>{this.#x(t.target.value)}))}}).hide();const z=new class{#C;#b;constructor(){this.#C="laptop",this.#b=new Map,this.#z()}#z(){this.#R("laptop-game",new w("game-canvas",new n(800,600))),this.#R("laptop-info",new w("info-canvas",new n(650,500))),this.#R("laptop-points",new w("points-canvas",new n(800,90))),this.#R("phone-game",new w("game-canvas",new n(300,300))),this.#R("phone-info",new w("info-canvas",new n(500,500))),this.#R("phone-points",new w("points-canvas",new n(300,90))),this.get("game").setCanvas(),this.get("info").setCanvas(),this.get("points").setCanvas()}#R(t,s){this.#b.set(t,s)}get(t){return this.#b.get(`${this.#C}-${t}`)}},R=new class extends r{#S;constructor(t,s=!0){super(t),this.#S=s,this.views=t.views,this.infoCanvas=this.views.get("info"),this.gameCanvas=this.views.get("game"),this.pointsCanvas=this.views.get("points")}draw(){this._clearCtx(),null!=this.ball&&this.ball.draw(this.gameCanvas.ctx),null!=this.player1&&this.player1.draw(this.gameCanvas.ctx),null!=this.player2&&this.player2.draw(this.gameCanvas.ctx),null!=this.collisionLeftRender&&this.collisionLeftRender.draw(),null!=this.collisionRightRender&&this.collisionRightRender.draw(),this.collisionLeft?.draw(),this.collisionRight?.draw(),this.pointCount?.draw(),this._drawPoints(this.gameCanvas.ctx),this.ball instanceof l&&this.ball?.drawText(this.infoCanvas.ctx),this.input?.draw&&this.input?.draw(),this.#S&&this._print()}getInfo(){return[[`${this.name} - game-canvas (${this.gameCanvas.size.x}, ${this.gameCanvas.size.y}), info-canvas (${this.infoCanvas.size.x}, ${this.infoCanvas.size.y}), points-canvas (${this.pointsCanvas.size.x}, ${this.pointsCanvas.size.y})`]]}_clearCtx(){this.gameCanvas.ctx.clearRect(0,0,this.gameCanvas.size.x,this.gameCanvas.size.y),this.infoCanvas.ctx.clearRect(0,0,this.infoCanvas.size.x,this.infoCanvas.size.y),this.pointsCanvas.ctx.clearRect(0,0,this.pointsCanvas.size.x,this.pointsCanvas.size.y)}}(new class{constructor(t){this.views=t,this.infoCanvas=t.get("info"),this.gameCanvas=t.get("game"),this.timer=new h,this.input=new g,this.printer=new y(this.infoCanvas.ctx);const s=new n(100,100),e=new n(this.gameCanvas.size.x/2,this.gameCanvas.size.y/2),i=new n(.5,.5);this.ball=new c(this.gameCanvas.size,e,s,i,new u(this.input),new d,this.printer,new n(5,5),new p)}}(z));!function t(s){R?.update(s),R?.draw(),requestAnimationFrame(t)}(0);
//# sourceMappingURL=ball.31ece108.js.map
