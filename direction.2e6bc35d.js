var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i={},s={},e=t.parcelRequire3f2e;null==e&&((e=function(t){if(t in i)return i[t].exports;if(t in s){var e=s[t];delete s[t];var n={id:t,exports:{}};return i[t]=n,e.call(n.exports,n,n.exports),n.exports}var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(t,i){s[t]=i},t.parcelRequire3f2e=e),e("3gXC5"),e("ic7rk"),e("9NZOq");class n{constructor(t,i){this.x=t,this.y=i}mag(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){const t=this.mag(),i=new n;return i.x=this.x/t,i.y=this.y/t,i}log(){console.log(`(${this.x}, ${this.y})`)}}class a{#t;constructor(t,i,s,e,a,r,o,h){this.gameSize=t,this.position=i,this.#t=new n(i.x,i.y),this.size=s,this.speed=e,this.inputHandler=a,this.render=r,this.printer=o,this.textPos=h,this.color="green",this.infoColor="white",this.name="entity"}update(t){this.inputHandler.handleInput(this),this.position.y-=t.deltaTime*this.speed.y,this.#i()}reverseXSpeed(){this.speed.x*=-1}reverseYSpeed(){this.speed.y*=-1}#i(){this.position.y<=this.size.y/2&&(this.position.y=this.size.y/2),this.position.y>=this.gameSize.y-this.size.y/2&&(this.position.y=this.gameSize.y-this.size.y/2)}reset(){this.position.x=this.#t.x,this.position.y=this.#t.y,this.speed.x=0,this.speed.y=0}draw(t){this.render.draw(t,this),this.drawInfo()}drawInfo(){const t=this.printer,i=this.getInfo();for(let s=0;s<i.length;s++)t?.print(`${i[s].join("   ")}`,this.textPos.x,this.textPos.y+40*s+40,this.infoColor)}getInfo(){return[[`${this.name} - size (${this.size.x.toFixed(0)}, ${this.size.y.toFixed(0)}), vel (${this.speed.x.toFixed(2)}, ${this.speed.y.toFixed(2)}), pos (${this.position.x.toFixed(0)}, ${this.position.y.toFixed(0)})`]]}}class r extends a{constructor(t,i,s,e,n,a,r,o){super(t,i,s,e,n,a.graphics,r,o)}draw(t){this.renderers.graphics.draw(t,this)}drawText(t){this.renderers.text.draw(t,this)}}class o extends r{constructor(t,i,s,e,n,a,r,o,h){super(t,i,s,e,n,a.graphics,r,o,h),this.name="Ball",this.wallCollision=h,this.renderers=a}update(t){this.inputHandler?.handleInput(this),this.#s(t),this.wallCollision?.calculateCollision(this)}#s(t){this.position.x+=t.deltaTime*this.speed.x,this.position.y+=t.deltaTime*this.speed.y}getInfo(){const t=super.getInfo();return t[0][0]=t[0][0].concat(`, wall (${this.wallCollision.log})`),t}}class h{constructor(t){this.gameFactory=t,this.screen=t.screen,this.timer=this.gameFactory.timer,this.input=this.gameFactory.input,this.ball=this.gameFactory.ball,this.player1=this.gameFactory.player1,this.player2=this.gameFactory.player2,this.collisionLeft=this.gameFactory.collisionLeft,this.collisionLeftRender=this.gameFactory.collisionLeftRender,this.collisionRight=this.gameFactory.collisionRight,this.collisionRightRender=this.gameFactory.collisionRightRender,this.printer=this.gameFactory.printer,this.pointCount=this.gameFactory.pointCount,this.name="Game"}update(t){this.timer.set(t),null!=this.ball&&this.ball.update(this.timer),null!=this.player1&&this.player1.update(this.timer),null!=this.player2&&this.player2.update(this.timer),null!=this.collisionLeft&&null!=this.ball&&null!=this.player1&&this.collisionLeft.calculateCollision(this.player1,this.ball),null!=this.collisionRight&&null!=this.ball&&null!=this.player2&&this.collisionRight.calculateCollision(this.player2,this.ball),this.pointCount?.update()}draw(){this._clearCtx(),null!=this.ball&&this.ball.draw(this.screen.gameCtx),null!=this.player1&&this.player1.draw(this.screen.gameCtx),null!=this.player2&&this.player2.draw(this.screen.gameCtx),null!=this.collisionLeftRender&&this.collisionLeftRender.draw(),null!=this.collisionRightRender&&this.collisionRightRender.draw(),this.collisionLeft?.draw(),this.collisionRight?.draw(),this.pointCount?.draw(),this._drawPoints(this.screen.gameCtx),this.ball instanceof o&&this.ball?.drawText(this.screen.textCtx),this._print()}_clearCtx(){this.screen.gameCtx.clearRect(0,0,this.screen.gameSize.x,this.screen.gameSize.y),this.screen.textCtx.clearRect(0,0,this.screen.textSize.x,this.screen.textSize.y)}_print(){const t=this.printer,i=this.getInfo();for(let s=0;s<i.length;s++)t?.print(`${i[s].join("     ")}`,5,20+40*s,this.infoColor)}getInfo(){return[["test"]]}_drawPoints(t,i=!1){i&&(t.fillStyle="white",t.fillRect(this.screen.gameSize.x/2-.5,this.screen.gameSize.y/2-.5,1,1))}}class l{constructor(){this.deltaTime=0,this.lastTime=0}set(t){const i=t-this.lastTime;i<20&&(this.deltaTime=i),this.lastTime=t}log(){console.log(this.deltaTime)}}class c{constructor(){this.keys=[],window.addEventListener("keydown",(t=>{"ArrowDown"!==t.key&&"ArrowUp"!==t.key&&"ArrowLeft"!==t.key&&"ArrowRight"!==t.key||-1!==this.keys.indexOf(t.key)||this.keys.push(t.key)})),window.addEventListener("keyup",(t=>{"ArrowDown"!==t.key&&"ArrowUp"!==t.key&&"ArrowLeft"!==t.key&&"ArrowRight"!==t.key||this.keys.splice(this.keys.indexOf(t.key),1)}))}}class d extends o{#e;#n;constructor(t,i,s,e,n,a,r,o,h,l,c=!1){super(t,i,s,e,n,a,r,o,h),this.bearing=l,this.#a(),this.#e=c}#a(){this.bearing.position=this.position,this.bearing.radius=300,this.bearing.rotatePolar(0)}draw(t){super.draw(t),!1!==this.#e&&(this.bearing?.draw(t),this.#r(t))}#o(){const t=new n(this.bearing.direction.x-this.bearing.position.x,this.bearing.direction.y-this.bearing.position.y).normalize();this.speed.x=.3*t.x,this.speed.y=.3*t.y}#r(t){t.strokeStyle="white",t.lineWidth=2,t.beginPath(),t.moveTo(this.position.x,this.position.y),t.lineTo(this.position.x+400*this.speed.x,this.position.y+400*this.speed.y),t.stroke()}start(t=2e3){this.bearing?.getBallDir(),this.#n=setTimeout((()=>{this.#o()}),t)}restart(t=2e3){this.reset(),this.start(t)}clearStart(){clearTimeout(this.#n)}}class p{constructor(t){this.input=t}handleInput(t){t.speed.x>0&&this.#h("ArrowLeft")||t.speed.x<0&&this.#h("ArrowRight")?this.#l(t):(t.speed.y>0&&this.#h("ArrowUp")||t.speed.y<0&&this.#h("ArrowDown"))&&this.#c(t)}#h(t){return this.input.keys.indexOf(t)>-1}#c(t){t.speed.y=-t.speed.y}#l(t){t.speed.x=-t.speed.x}}class g{constructor(){this.log=""}calculateCollision(t){if(t.size.x!=t.size.y)throw"This collider works only for rectangles!";const i=t.size.x/2,s=t.gameSize;t.position.y<=i&&(t.position.y=i,this.log="top",t.reverseYSpeed()),t.position.y>=s.y-i&&(t.position.y=s.y-i,this.log="bottom",t.reverseYSpeed())}}class y{drawRect(t,i,s,e,n){t.fillStyle=n,t.fillRect(i-e/2,s-e/2,e,e)}}class u extends y{draw(t,i){this.drawRect(t,i.position.x,i.position.y,i.size.x,"red")}}class w{constructor(t){this.ctx=t,this.setPrint("left","normal 12px Arial")}setPrint(t,i){this.ctx.textAlign=t,this.ctx.font=i}print(t,i,s,e){this.ctx.fillStyle=e,this.ctx.fillText(t,i,s)}printInLines(t,i,s,e,n){let a=n;t.forEach((t=>{this.print(t,e,a,i),a+=s}))}}class x{constructor(t,i,s){this.renders=t,this.printer=i,this.textPos=s}draw(t,i){this.renders.forEach((s=>{s.draw(t,i)}))}}class m{setPrint(t,i,s){t.textAlign=i,t.font=s}print(t,i,s,e,n){t.fillStyle=n,t.fillText(i,s,e)}printInLines(t,i,s,e,n,a){let r=a;i.forEach((i=>{this.print(t,i,n,r,s),r+=e}))}}class f extends m{draw(t,i){const s=i.getInfo();for(let e=0;e<s.length;e++)this.print(t,`${s[e].join("   ")}`,i.textPos.x,i.textPos.y+40*e+40,i.infoColor)}}class v{#d;#p;#g;#y;constructor(){this.#d=new n,this.#y=new n}set position(t){this.#d.x=t.x,this.#d.y=t.y}set radius(t){this.#g=t}get#u(){return this.#p*(Math.PI/180)}get direction(){return this.#y}get position(){return this.#d}rotatePolar(t){this.#p=t,this.#y.x=this.#d.x+this.#g*Math.cos(this.#u),this.#y.y=this.#d.y+this.#g*Math.sin(this.#u)}rotate(t){this.#p=t;const i=new n(this.#y.x-this.#d.x,this.#y.y-this.#d.y),s=i.x,e=i.y,a=Math.cos(this.#u),r=Math.sin(this.#u),o=new n(s*a-e*r,s*r+e*a);this.#y.x=o.x+this.#d.x,this.#y.y=o.y+this.#d.y}draw(t){t.strokeStyle="orange",t.lineWidth=2,t.beginPath(),t.moveTo(this.#d.x,this.#d.y),t.lineTo(this.#y.x,this.#y.y),t.stroke()}#w(){this.rotatePolar(0),0===this.#x(0,1)?this.rotate(this.#x(-30,-5)):this.rotate(this.#x(5,30))}#m(){this.rotatePolar(0),0===this.#x(0,1)?this.rotate(this.#x(-150,-175)):this.rotate(this.#x(-185,-210))}getBallDir(){0===this.#x(0,1)?this.#w():this.#m()}#x(t,i){return Math.floor(Math.random()*(i-t+1)+t)}}class C{#f;#v;#C;#b;constructor(t,i){this.#f=t,this.#v=i}get canvasId(){return this.#f}get size(){return this.#v}get canvas(){return this.#C}get ctx(){return this.#b}setCanvas(){this.#C=document.getElementById(this.#f),this.#C.width=this.#v.x,this.#C.height=this.#v.y,this.#b=this.#C.getContext("2d")}}const b=new class{#z;#R;constructor(){this.#z="laptop",this.#R=new Map,this.#k()}#k(){this.#I("laptop-game",new C("game-canvas",new n(800,600))),this.#I("laptop-info",new C("info-canvas",new n(650,500))),this.#I("laptop-points",new C("points-canvas",new n(800,90))),this.#I("phone-game",new C("game-canvas",new n(300,300))),this.#I("phone-info",new C("info-canvas",new n(500,500))),this.#I("phone-points",new C("points-canvas",new n(300,90))),this.get("game").setCanvas(),this.get("info").setCanvas(),this.get("points").setCanvas()}#I(t,i){this.#R.set(t,i)}get(t){return this.#R.get(`${this.#z}-${t}`)}};let z=0;window.addEventListener("load",(function(){const t=document.getElementById("slider1");t.value=z;const i=document.getElementById("value1");i.innerHTML=z,t.addEventListener("change",(function(t){z=t.target.value,i.innerHTML=z}));const s=document.getElementById("btn-rotate"),e=document.getElementById("polar"),n=document.getElementById("matrix");let a=!0;e.addEventListener("change",(function(t){a=t.target.checked})),n.addEventListener("change",(function(t){a=!t.target.checked})),s.addEventListener("click",(function(t){!function(t,i){t?R.ball.bearing.rotatePolar(i):R.ball.bearing.rotate(i)}(a,z)}));document.getElementById("btn-start").addEventListener("click",(function(t){R.ball.start(0),setTimeout((()=>{R.ball.reset(),R.ball.bearing.rotatePolar(0)}),2e3)}))}));const R=new class extends h{#S;constructor(t,i=!0){super(t),this.#S=i,this.views=t.views,this.infoCanvas=this.views.get("info"),this.gameCanvas=this.views.get("game"),this.pointsCanvas=this.views.get("points")}draw(){this._clearCtx(),null!=this.ball&&this.ball.draw(this.gameCanvas.ctx),null!=this.player1&&this.player1.draw(this.gameCanvas.ctx),null!=this.player2&&this.player2.draw(this.gameCanvas.ctx),null!=this.collisionLeftRender&&this.collisionLeftRender.draw(),null!=this.collisionRightRender&&this.collisionRightRender.draw(),this.collisionLeft?.draw(),this.collisionRight?.draw(),this.pointCount?.draw(),this._drawPoints(this.gameCanvas.ctx),this.ball instanceof o&&this.ball?.drawText(this.infoCanvas.ctx),this.input?.draw&&this.input?.draw(),this.#S&&this._print()}getInfo(){return[[`${this.name} - game-canvas (${this.gameCanvas.size.x}, ${this.gameCanvas.size.y}), info-canvas (${this.infoCanvas.size.x}, ${this.infoCanvas.size.y}), points-canvas (${this.pointsCanvas.size.x}, ${this.pointsCanvas.size.y})`]]}_clearCtx(){this.gameCanvas.ctx.clearRect(0,0,this.gameCanvas.size.x,this.gameCanvas.size.y),this.infoCanvas.ctx.clearRect(0,0,this.infoCanvas.size.x,this.infoCanvas.size.y),this.pointsCanvas.ctx.clearRect(0,0,this.pointsCanvas.size.x,this.pointsCanvas.size.y)}}(new class{constructor(t){this.views=t,this.infoCanvas=t.get("info"),this.gameCanvas=t.get("game"),this.timer=new l,this.printer=new w(this.infoCanvas.ctx),this.input=new c,this.renderers={graphics:new x([new u]),text:new x([new f])};const i=new n(20,20),s=new n(this.gameCanvas.size.x/2,this.gameCanvas.size.y/2),e=new n(0,0),a=new n(5,5);this.bearing=new v,this.ball=new d(this.gameCanvas.size,s,i,e,new p(this.input),this.renderers,this.printer,a,new g,this.bearing,!0)}}(b));!function t(i){R.update(i),R.draw(),requestAnimationFrame(t)}(0);
//# sourceMappingURL=direction.2e6bc35d.js.map
