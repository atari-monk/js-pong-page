var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i={},s={},e=t.parcelRequire3f2e;null==e&&((e=function(t){if(t in i)return i[t].exports;if(t in s){var e=s[t];delete s[t];var l={id:t,exports:{}};return i[t]=l,e.call(l.exports,l,l.exports),l.exports}var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(t,i){s[t]=i},t.parcelRequire3f2e=e),e("3gXC5"),e("ic7rk"),e("9NZOq");class l{constructor(t,i){this.x=t,this.y=i}mag(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){const t=this.mag(),i=new l;return i.x=this.x/t,i.y=this.y/t,i}log(){console.log(`(${this.x}, ${this.y})`)}}class n{#t;constructor(t,i,s,e,n,o,a,h){this.gameSize=t,this.position=i,this.#t=new l(i.x,i.y),this.size=s,this.speed=e,this.inputHandler=n,this.render=o,this.printer=a,this.textPos=h,this.color="green",this.infoColor="white",this.name="entity"}update(t){this.inputHandler.handleInput(this),this.position.y-=t.deltaTime*this.speed.y,this.#i()}reverseXSpeed(){this.speed.x*=-1}reverseYSpeed(){this.speed.y*=-1}#i(){this.position.y<=this.size.y/2&&(this.position.y=this.size.y/2),this.position.y>=this.gameSize.y-this.size.y/2&&(this.position.y=this.gameSize.y-this.size.y/2)}reset(){this.position.x=this.#t.x,this.position.y=this.#t.y,this.speed.x=0,this.speed.y=0}draw(t){this.render.draw(t,this),this.drawInfo()}drawInfo(){const t=this.printer,i=this.getInfo();for(let s=0;s<i.length;s++)t?.print(`${i[s].join("   ")}`,this.textPos.x,this.textPos.y+40*s+40,this.infoColor)}getInfo(){return[[`${this.name} - size (${this.size.x.toFixed(0)}, ${this.size.y.toFixed(0)}), vel (${this.speed.x.toFixed(2)}, ${this.speed.y.toFixed(2)}), pos (${this.position.x.toFixed(0)}, ${this.position.y.toFixed(0)})`]]}}class o extends n{constructor(t,i,s,e,l,n,o,a){super(t,i,s,e,l,n.graphics,o,a)}draw(t){this.renderers.graphics.draw(t,this)}drawText(t){this.renderers.text.draw(t,this)}}class a extends o{constructor(t,i,s,e,l,n,o,a,h){super(t,i,s,e,l,n.graphics,o,a,h),this.name="Ball",this.wallCollision=h,this.renderers=n}update(t){this.inputHandler?.handleInput(this),this.#s(t),this.wallCollision?.calculateCollision(this)}#s(t){this.position.x+=t.deltaTime*this.speed.x,this.position.y+=t.deltaTime*this.speed.y}getInfo(){const t=super.getInfo();return t[0][0]=t[0][0].concat(`, wall (${this.wallCollision.log})`),t}}class h{constructor(t){this.gameFactory=t,this.screen=t.screen,this.timer=this.gameFactory.timer,this.input=this.gameFactory.input,this.ball=this.gameFactory.ball,this.player1=this.gameFactory.player1,this.player2=this.gameFactory.player2,this.collisionLeft=this.gameFactory.collisionLeft,this.collisionLeftRender=this.gameFactory.collisionLeftRender,this.collisionRight=this.gameFactory.collisionRight,this.collisionRightRender=this.gameFactory.collisionRightRender,this.printer=this.gameFactory.printer,this.pointCount=this.gameFactory.pointCount,this.name="Game"}update(t){this.timer.set(t),null!=this.ball&&this.ball.update(this.timer),null!=this.player1&&this.player1.update(this.timer),null!=this.player2&&this.player2.update(this.timer),null!=this.collisionLeft&&null!=this.ball&&null!=this.player1&&this.collisionLeft.calculateCollision(this.player1,this.ball),null!=this.collisionRight&&null!=this.ball&&null!=this.player2&&this.collisionRight.calculateCollision(this.player2,this.ball),this.pointCount?.update()}draw(){this._clearCtx(),null!=this.ball&&this.ball.draw(this.screen.gameCtx),null!=this.player1&&this.player1.draw(this.screen.gameCtx),null!=this.player2&&this.player2.draw(this.screen.gameCtx),null!=this.collisionLeftRender&&this.collisionLeftRender.draw(),null!=this.collisionRightRender&&this.collisionRightRender.draw(),this.collisionLeft?.draw(),this.collisionRight?.draw(),this.pointCount?.draw(),this._drawPoints(this.screen.gameCtx),this.ball instanceof a&&this.ball?.drawText(this.screen.textCtx),this._print()}_clearCtx(){this.screen.gameCtx.clearRect(0,0,this.screen.gameSize.x,this.screen.gameSize.y),this.screen.textCtx.clearRect(0,0,this.screen.textSize.x,this.screen.textSize.y)}_print(){const t=this.printer,i=this.getInfo();for(let s=0;s<i.length;s++)t?.print(`${i[s].join("     ")}`,5,20+40*s,this.infoColor)}getInfo(){return[["test"]]}_drawPoints(t,i=!1){i&&(t.fillStyle="white",t.fillRect(this.screen.gameSize.x/2-.5,this.screen.gameSize.y/2-.5,1,1))}}class r extends h{#e;constructor(t,i=!0){super(t),this.#e=i,this.views=t.views,this.infoCanvas=this.views.get("info"),this.gameCanvas=this.views.get("game"),this.pointsCanvas=this.views.get("points")}draw(){this._clearCtx(),null!=this.ball&&this.ball.draw(this.gameCanvas.ctx),null!=this.player1&&this.player1.draw(this.gameCanvas.ctx),null!=this.player2&&this.player2.draw(this.gameCanvas.ctx),null!=this.collisionLeftRender&&this.collisionLeftRender.draw(),null!=this.collisionRightRender&&this.collisionRightRender.draw(),this.collisionLeft?.draw(),this.collisionRight?.draw(),this.pointCount?.draw(),this._drawPoints(this.gameCanvas.ctx),this.ball instanceof a&&this.ball?.drawText(this.infoCanvas.ctx),this.input?.draw&&this.input?.draw(),this.#e&&this._print()}getInfo(){return[[`${this.name} - game-canvas (${this.gameCanvas.size.x}, ${this.gameCanvas.size.y}), info-canvas (${this.infoCanvas.size.x}, ${this.infoCanvas.size.y}), points-canvas (${this.pointsCanvas.size.x}, ${this.pointsCanvas.size.y})`]]}_clearCtx(){this.gameCanvas.ctx.clearRect(0,0,this.gameCanvas.size.x,this.gameCanvas.size.y),this.infoCanvas.ctx.clearRect(0,0,this.infoCanvas.size.x,this.infoCanvas.size.y),this.pointsCanvas.ctx.clearRect(0,0,this.pointsCanvas.size.x,this.pointsCanvas.size.y)}}class c{constructor(){this.deltaTime=0,this.lastTime=0}set(t){const i=t-this.lastTime;i<20&&(this.deltaTime=i),this.lastTime=t}log(){console.log(this.deltaTime)}}class p{handleInput(){}}class y{constructor(){this.keys=[],window.addEventListener("keydown",(t=>{"ArrowDown"!==t.key&&"ArrowUp"!==t.key&&"ArrowLeft"!==t.key&&"ArrowRight"!==t.key||-1!==this.keys.indexOf(t.key)||this.keys.push(t.key)})),window.addEventListener("keyup",(t=>{"ArrowDown"!==t.key&&"ArrowUp"!==t.key&&"ArrowLeft"!==t.key&&"ArrowRight"!==t.key||this.keys.splice(this.keys.indexOf(t.key),1)}))}}class d extends n{constructor(t,i,s,e,l,n,o,a,h){super(t,i,s,e,l,n,o,a),this.name="Ball",this.wallCollision=h}update(t){this.inputHandler?.handleInput(this),this.#s(t),this.wallCollision.calculateCollision(this)}#s(t){this.position.x+=t.deltaTime*this.speed.x,this.position.y+=t.deltaTime*this.speed.y}getInfo(){const t=super.getInfo();return t[0][0]=t[0][0].concat(`, wall (${this.wallCollision.log})`),t}}class g{constructor(t){this.input=t}handleInput(t){const i=.1;this.input.keys.indexOf("ArrowLeft")>-1?t.speed.x=-.1:this.input.keys.indexOf("ArrowRight")>-1?t.speed.x=i:this.input.keys.indexOf("ArrowUp")>-1?t.speed.y=-.1:this.input.keys.indexOf("ArrowDown")>-1&&(t.speed.y=i)}}class x{draw(t,i){if(i.size.x!=i.size.y)throw"This collider works only for rectangles!";this.#l(t,i),this.#n(t,i)}#l(t,i){var s=i.size.x;t.fillStyle="green",t.fillRect(i.position.x-s/2,i.position.y-s/2,s,s)}#n(t,i){t.fillStyle="yellow",t.fillRect(i.position.x-2.5,i.position.y-2.5,5,5)}}class w{constructor(){this.log=""}calculateCollision(t){if(t.size.x!=t.size.y)throw"This collider works only for rectangles!";const i=t.size.x/2,s=t.gameSize;t.position.x<=i&&(t.position.x=i,this.log="left",t.reverseXSpeed()),t.position.x>=s.x-i&&(t.position.x=s.x-i,this.log="right",t.reverseXSpeed()),t.position.y<=i&&(t.position.y=i,this.log="top",t.reverseYSpeed()),t.position.y>=s.y-i&&(t.position.y=s.y-i,this.log="bottom",t.reverseYSpeed())}}class C extends n{constructor(t,i,s,e,l,n,o,a,h="Player"){super(t,i,s,e,l,n,o,a),this.name=h}}class u{constructor(t,i){this.ctx=t,this.pongCollision=i}draw(){this.pongCollision.region&&this.#o()}#o(){this.ctx.fillStyle="red",this.ctx.fillRect(this.pongCollision.ballX-2.5,this.pongCollision.ballY1-2.5,5,5),this.ctx.fillRect(this.pongCollision.ballX-2.5,this.pongCollision.ballY2-2.5,5,5),this.ctx.fillRect(this.pongCollision.playerX-2.5,this.pongCollision.playerY1-2.5,5,5),this.ctx.fillRect(this.pongCollision.playerX-2.5,this.pongCollision.playerY2-2.5,5,5)}}class m{draw(t,i){t.fillStyle="green",t.fillRect(i.position.x-i.size.x/2,i.position.y-i.size.y/2,i.size.x,i.size.y)}}class f{constructor(t){this.ctx=t,this.setPrint("left","normal 12px Arial")}setPrint(t,i){this.ctx.textAlign=t,this.ctx.font=i}print(t,i,s,e){this.ctx.fillStyle=e,this.ctx.fillText(t,i,s)}printInLines(t,i,s,e,l){let n=l;t.forEach((t=>{this.print(t,e,n,i),n+=s}))}}class v{constructor(t){this.printer=t,this.ballY1=0,this.playerY1=0,this.ballY2=0,this.playerY2=0,this.ballX=0,this.playerX=0,this.xCollision=!1,this.yCollision=!1,this.xyCollision=!1,this.regionX=!1,this.regionY=!1,this.region=!1}calculateCollision(t,i){this.#a(t,i),this.#h(i),this.region&&(this.#r(),this.#c(),this.xyCollision=this.xCollision&&this.yCollision,this.xyCollision&&i.reverseXSpeed())}#a(t,i){this.ballX=i.position.x-i.size.x/2,this.playerX=t.position.x+t.size.x/2,this.ballY1=i.position.y-i.size.x/2,this.ballY2=i.position.y+i.size.x/2,this.playerY1=t.position.y-t.size.y/2,this.playerY2=t.position.y+t.size.y/2}#h(t){this.regionX=this.ballX>=this.playerX-t.size.x/2&&this.ballX<=this.playerX+2*t.size.x,this.regionY=this.ballY1>=this.playerY1-t.size.x&&this.ballY1<=this.playerY2+t.size.x&&this.ballY2>=this.playerY1-t.size.x&&this.ballY2<=this.playerY2+t.size.x,this.region=this.regionX&&this.regionY}#r(){this.xCollision=this.ballX<=this.playerX}#c(){this.yCollision=(this.playerY1<=this.ballY1||this.playerY1<=this.ballY2)&&(this.playerY2>=this.ballY2||this.playerY2>=this.ballY1)}draw(){this.printer.print(`BallColl - ${this.getInfo()[0].join(", ")}`,5,95,"white"),this.printer.print(`BallColl - ${this.getInfo()[1].join(", ")}`,5,120,"white"),this.printer.print(`BallColl - ${this.getInfo()[2].join(", ")}`,5,145,"white")}getInfo(){return[[`ball x ${this.ballX.toFixed(0)}, y1 ${this.ballY1.toFixed(0)}, y2 ${this.ballY2.toFixed(0)}`],[`player x ${this.playerX.toFixed(0)}, y1 ${this.playerY1.toFixed(0)}, y2 ${this.playerY2.toFixed(0)}`],[`regionXY (${this.regionX}, ${this.regionY})`,`collXY (${this.xCollision}, ${this.yCollision})`,`region (${this.region})`,`coll (${this.xyCollision})`]]}}class b{constructor(t){this.views=t,this.infoCanvas=t.get("info"),this.gameCanvas=t.get("game"),this.timer=new c,this.input=new y,this.printer=new f(this.infoCanvas.ctx),this.ball=new d(this.gameCanvas.size,new l(this.gameCanvas.size.x/2+70,this.gameCanvas.size.y/2),new l(40,40),new l(0,0),new g(this.input),new x,this.printer,new l(5,5),new w),this.player1=new C(this.gameCanvas.size,new l(this.gameCanvas.size.x/2,this.gameCanvas.size.y/2),new l(40,200),new l(0,0),new p,new m,this.printer,new l(5,30)),this.collisionLeft=new v(this.printer),this.collisionLeftRender=new u(this.gameCanvas.ctx,this.collisionLeft)}}class z{constructor(t){this.printer=t,this.ballY1=0,this.playerY1=0,this.ballY2=0,this.playerY2=0,this.ballX=0,this.playerX=0,this.xCollision=!1,this.yCollision=!1,this.xyCollision=!1,this.regionX=!1,this.regionY=!1,this.region=!1}calculateCollision(t,i){this.#a(t,i),this.#h(i),this.region&&(this.#r(),this.#c(),this.xyCollision=this.xCollision&&this.yCollision,this.xyCollision&&i.reverseXSpeed())}#a(t,i){this.ballX=i.position.x+i.size.x/2,this.playerX=t.position.x-t.size.x/2,this.ballY1=i.position.y-i.size.x/2,this.ballY2=i.position.y+i.size.x/2,this.playerY1=t.position.y-t.size.y/2,this.playerY2=t.position.y+t.size.y/2}#h(t){this.regionX=this.ballX<=this.playerX+t.size.x/2&&this.ballX>=this.playerX-2*t.size.x,this.regionY=this.ballY1>=this.playerY1-t.size.x&&this.ballY1<=this.playerY2+t.size.x&&this.ballY2>=this.playerY1-t.size.x&&this.ballY2<=this.playerY2+t.size.x,this.region=this.regionX&&this.regionY}#r(){this.xCollision=this.ballX>=this.playerX}#c(){this.yCollision=(this.playerY1<=this.ballY1||this.playerY1<=this.ballY2)&&(this.playerY2>=this.ballY2||this.playerY2>=this.ballY1)}draw(){this.printer.print(`BallColl - ${this.getInfo()[0].join(", ")}`,5,95,"white"),this.printer.print(`BallColl - ${this.getInfo()[1].join(", ")}`,5,120,"white"),this.printer.print(`BallColl - ${this.getInfo()[2].join(", ")}`,5,145,"white")}getInfo(){return[[`ball x ${this.ballX.toFixed(0)}, y1 ${this.ballY1.toFixed(0)}, y2 ${this.ballY2.toFixed(0)}`],[`player x ${this.playerX.toFixed(0)}, y1 ${this.playerY1.toFixed(0)}, y2 ${this.playerY2.toFixed(0)}`],[`regionXY (${this.regionX}, ${this.regionY})`,`collXY (${this.xCollision}, ${this.yCollision})`,`region (${this.region})`,`coll (${this.xyCollision})`]]}}class Y{constructor(t){this.views=t,this.infoCanvas=t.get("info"),this.gameCanvas=t.get("game"),this.timer=new c,this.input=new y,this.printer=new f(this.infoCanvas.ctx),this.ball=new d(this.gameCanvas.size,new l(this.gameCanvas.size.x/2-70,this.gameCanvas.size.y/2),new l(40,40),new l(0,0),new g(this.input),new x,this.printer,new l(5,5),new w),this.player2=new C(this.gameCanvas.size,new l(this.gameCanvas.size.x/2,this.gameCanvas.size.y/2),new l(40,200),new l(0,0),new p,new m,this.printer,new l(5,30)),this.collisionRight=new z(this.printer),this.collisionRightRender=new u(this.gameCanvas.ctx,this.collisionRight)}}class R{#p;#y;#d;#g;constructor(t,i){this.#p=t,this.#y=i}get canvasId(){return this.#p}get size(){return this.#y}get canvas(){return this.#d}get ctx(){return this.#g}setCanvas(){this.#d=document.getElementById(this.#p),this.#d.width=this.#y.x,this.#d.height=this.#y.y,this.#g=this.#d.getContext("2d")}}const X="hide",$="select-controls-player",L="menu-container",I="btn-start",S="btn-reset",k="btn-overlay";let P,F;const B=new class{#x;#w;constructor(){this.#x="laptop",this.#w=new Map,this.#C()}#C(){this.#u("laptop-game",new R("game-canvas",new l(800,600))),this.#u("laptop-info",new R("info-canvas",new l(650,500))),this.#u("laptop-points",new R("points-canvas",new l(800,90))),this.#u("phone-game",new R("game-canvas",new l(300,300))),this.#u("phone-info",new R("info-canvas",new l(500,500))),this.#u("phone-points",new R("points-canvas",new l(300,90))),this.get("game").setCanvas(),this.get("info").setCanvas(),this.get("points").setCanvas()}#u(t,i){this.#w.set(t,i)}get(t){return this.#w.get(`${this.#x}-${t}`)}};new class{#m;#f;#v;#b;#z;#Y;#R;static get hide(){return X}static get selectGame(){return"select-controls-game"}static get selectPlayer(){return $}static get menuContainer(){return L}static get btnStart(){return I}static get btnReset(){return S}static get btnOverlay(){return k}constructor(t){this.#R=t,this.#m=document.getElementById(L),this.#f=document.getElementById("menu-btns"),this.#v=document.getElementById(I),this.#b=document.getElementById(S),this.#z=document.getElementById(k),this.#X(),this.#Y=document.getElementById("select-controls-container")}#X(){HTMLSelectElement.prototype.__defineGetter__("val",(function(){return this.options[this.selectedIndex].value})),HTMLSelectElement.prototype.__defineGetter__("text",(function(){return this.options[this.selectedIndex].text}))}setPlayerView(t){this.#R(this.#Y.childNodes[3].val),this.#v.classList.add(X),this.#b.classList.add(X),this.#z.classList.add(X),this.#Y.classList.add($),this.#$(t)}setMyCollisionView(t){this.#R(this.#Y.childNodes[3].val),this.#Y.classList.add($),this.#Y.classList.remove(X),this.#m.classList.remove(X),this.#$(t)}setGameView(){this.#m.classList.remove(X),this.#f.classList.remove(X),this.#v.classList.remove(X),this.#b.classList.remove(X),this.#z.classList.remove(X)}hide(){this.#v.classList.add(X),this.#b.classList.add(X),this.#z.classList.add(X),this.#Y.classList.add(X)}#$(){this.#Y.addEventListener("change",(t=>{this.#R(t.target.value)}))}}((function(t){switch(t){case"left":F=new b(B);break;case"right":F=new Y(B)}P=new r(F)})).setMyCollisionView(),function t(i){P.update(i),P.draw(),requestAnimationFrame(t)}(0);
//# sourceMappingURL=my-collision.4d3fae50.js.map
