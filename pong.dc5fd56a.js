var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i={},s={},e=t.parcelRequire3f2e;null==e&&((e=function(t){if(t in i)return i[t].exports;if(t in s){var e=s[t];delete s[t];var n={id:t,exports:{}};return i[t]=n,e.call(n.exports,n,n.exports),n.exports}var o=new Error("Cannot find module '"+t+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(t,i){s[t]=i},t.parcelRequire3f2e=e),e("3gXC5"),e("ic7rk"),e("9NZOq");class n{constructor(t,i){this.x=t,this.y=i}mag(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){const t=this.mag(),i=new n;return i.x=this.x/t,i.y=this.y/t,i}log(){console.log(`(${this.x}, ${this.y})`)}}class o{#t;constructor(t,i,s,e,o,r,a,h){this.gameSize=t,this.position=i,this.#t=new n(i.x,i.y),this.size=s,this.speed=e,this.inputHandler=o,this.render=r,this.printer=a,this.textPos=h,this.color="green",this.infoColor="white",this.name="entity"}update(t){this.inputHandler.handleInput(this),this.position.y-=t.deltaTime*this.speed.y,this.#i()}reverseXSpeed(){this.speed.x*=-1}reverseYSpeed(){this.speed.y*=-1}#i(){this.position.y<=this.size.y/2&&(this.position.y=this.size.y/2),this.position.y>=this.gameSize.y-this.size.y/2&&(this.position.y=this.gameSize.y-this.size.y/2)}reset(){this.position.x=this.#t.x,this.position.y=this.#t.y,this.speed.x=0,this.speed.y=0}draw(t){this.render.draw(t,this),this.drawInfo()}drawInfo(){const t=this.printer,i=this.getInfo();for(let s=0;s<i.length;s++)t?.print(`${i[s].join("   ")}`,this.textPos.x,this.textPos.y+40*s+40,this.infoColor)}getInfo(){return[[`${this.name} - size (${this.size.x.toFixed(0)}, ${this.size.y.toFixed(0)}), vel (${this.speed.x.toFixed(2)}, ${this.speed.y.toFixed(2)}), pos (${this.position.x.toFixed(0)}, ${this.position.y.toFixed(0)})`]]}}class r extends o{constructor(t,i,s,e,n,o,r,a){super(t,i,s,e,n,o.graphics,r,a)}draw(t){this.renderers.graphics.draw(t,this)}drawText(t){this.renderers.text.draw(t,this)}}class a extends r{constructor(t,i,s,e,n,o,r,a,h){super(t,i,s,e,n,o.graphics,r,a,h),this.name="Ball",this.wallCollision=h,this.renderers=o}update(t){this.inputHandler?.handleInput(this),this.#s(t),this.wallCollision?.calculateCollision(this)}#s(t){this.position.x+=t.deltaTime*this.speed.x,this.position.y+=t.deltaTime*this.speed.y}getInfo(){const t=super.getInfo();return t[0][0]=t[0][0].concat(`, wall (${this.wallCollision.log})`),t}}class h{constructor(t){this.gameFactory=t,this.screen=t.screen,this.timer=this.gameFactory.timer,this.input=this.gameFactory.input,this.ball=this.gameFactory.ball,this.player1=this.gameFactory.player1,this.player2=this.gameFactory.player2,this.collisionLeft=this.gameFactory.collisionLeft,this.collisionLeftRender=this.gameFactory.collisionLeftRender,this.collisionRight=this.gameFactory.collisionRight,this.collisionRightRender=this.gameFactory.collisionRightRender,this.printer=this.gameFactory.printer,this.pointCount=this.gameFactory.pointCount,this.name="Game"}update(t){this.timer.set(t),null!=this.ball&&this.ball.update(this.timer),null!=this.player1&&this.player1.update(this.timer),null!=this.player2&&this.player2.update(this.timer),null!=this.collisionLeft&&null!=this.ball&&null!=this.player1&&this.collisionLeft.calculateCollision(this.player1,this.ball),null!=this.collisionRight&&null!=this.ball&&null!=this.player2&&this.collisionRight.calculateCollision(this.player2,this.ball),this.pointCount?.update()}draw(){this._clearCtx(),null!=this.ball&&this.ball.draw(this.screen.gameCtx),null!=this.player1&&this.player1.draw(this.screen.gameCtx),null!=this.player2&&this.player2.draw(this.screen.gameCtx),null!=this.collisionLeftRender&&this.collisionLeftRender.draw(),null!=this.collisionRightRender&&this.collisionRightRender.draw(),this.collisionLeft?.draw(),this.collisionRight?.draw(),this.pointCount?.draw(),this._drawPoints(this.screen.gameCtx),this.ball instanceof a&&this.ball?.drawText(this.screen.textCtx),this._print()}_clearCtx(){this.screen.gameCtx.clearRect(0,0,this.screen.gameSize.x,this.screen.gameSize.y),this.screen.textCtx.clearRect(0,0,this.screen.textSize.x,this.screen.textSize.y)}_print(){const t=this.printer,i=this.getInfo();for(let s=0;s<i.length;s++)t?.print(`${i[s].join("     ")}`,5,20+40*s,this.infoColor)}getInfo(){return[["test"]]}_drawPoints(t,i=!1){i&&(t.fillStyle="white",t.fillRect(this.screen.gameSize.x/2-.5,this.screen.gameSize.y/2-.5,1,1))}}class l{constructor(){this.deltaTime=0,this.lastTime=0}set(t){const i=t-this.lastTime;i<20&&(this.deltaTime=i),this.lastTime=t}log(){console.log(this.deltaTime)}}class c{handleInput(){}}class d{constructor(){this.keys=[],window.addEventListener("keydown",(t=>{"ArrowDown"!==t.key&&"ArrowUp"!==t.key&&"ArrowLeft"!==t.key&&"ArrowRight"!==t.key||-1!==this.keys.indexOf(t.key)||this.keys.push(t.key)})),window.addEventListener("keyup",(t=>{"ArrowDown"!==t.key&&"ArrowUp"!==t.key&&"ArrowLeft"!==t.key&&"ArrowRight"!==t.key||this.keys.splice(this.keys.indexOf(t.key),1)}))}}class p extends a{#e;#n;constructor(t,i,s,e,n,o,r,a,h,l,c=!1){super(t,i,s,e,n,o,r,a,h),this.bearing=l,this.#o(),this.#e=c}#o(){this.bearing.position=this.position,this.bearing.radius=300,this.bearing.rotatePolar(0)}draw(t){super.draw(t),!1!==this.#e&&(this.bearing?.draw(t),this.#r(t))}#a(){const t=new n(this.bearing.direction.x-this.bearing.position.x,this.bearing.direction.y-this.bearing.position.y).normalize();this.speed.x=.3*t.x,this.speed.y=.3*t.y}#r(t){t.strokeStyle="white",t.lineWidth=2,t.beginPath(),t.moveTo(this.position.x,this.position.y),t.lineTo(this.position.x+400*this.speed.x,this.position.y+400*this.speed.y),t.stroke()}start(t=2e3){this.bearing?.getBallDir(),this.#n=setTimeout((()=>{this.#a()}),t)}restart(t=2e3){this.reset(),this.start(t)}clearStart(){clearTimeout(this.#n)}}class y{drawRect(t,i,s,e,n){t.fillStyle=n,t.fillRect(i-e/2,s-e/2,e,e)}}class g extends y{draw(t,i){this.drawRect(t,i.position.x,i.position.y,i.size.x,"red")}}class u{constructor(){this.log=""}calculateCollision(t){if(t.size.x!=t.size.y)throw"This collider works only for rectangles!";const i=t.size.x/2,s=t.gameSize;t.position.y<=i&&(t.position.y=i,this.log="top",t.reverseYSpeed()),t.position.y>=s.y-i&&(t.position.y=s.y-i,this.log="bottom",t.reverseYSpeed())}}class m extends o{constructor(t,i,s,e,n,o,r,a,h="Player"){super(t,i,s,e,n,o,r,a),this.name=h}}class w{constructor(t){this.input=t}handleInput(t){this.input.keys.indexOf("ArrowUp")>-1?t.speed.y=1:this.input.keys.indexOf("ArrowDown")>-1?t.speed.y=-1:t.speed.y=0}}class x{constructor(){this.playerLeftTop=new n(0,0),this.ballLeftTop=new n(0,0)}calculateCollision(t,i){this.playerLeftTop=new n(t.position.x-t.size.x/2,t.position.y-t.size.y/2),this.ballLeftTop=new n(i.position.x-i.size.x/2,i.position.y-i.size.y/2),this.playerLeftTop.x>this.ballLeftTop.x+i.size.x||this.playerLeftTop.x+t.size.x<this.ballLeftTop.x||this.playerLeftTop.y>this.ballLeftTop.y+i.size.y||this.playerLeftTop.y+t.size.y<this.ballLeftTop.y?t.color="yellow":(t.color="red",i.reverseXSpeed())}draw(){}}class v{constructor(t){this.ctx=t,this.setPrint("left","normal 12px Arial")}setPrint(t,i){this.ctx.textAlign=t,this.ctx.font=i}print(t,i,s,e){this.ctx.fillStyle=e,this.ctx.fillText(t,i,s)}printInLines(t,i,s,e,n){let o=n;t.forEach((t=>{this.print(t,e,o,i),o+=s}))}}class f extends v{#h;#l;#c;#d;#p;#y;constructor(t,i){super(t.get("points").ctx),this.#h=t.get("points").size.x/2,this.#c=t.get("game").size,this.#d=i,this.reset()}update(){this.#g()?this.#u():this.#m()?this.#w():this.#x()&&this.#v()}#m(){return this.#d.position.x>=this.#c.x&&this.#l}#w(){this.#l=!1,this.#p+=1}#g(){return this.#d.position.x<=0&&this.#l}#u(){this.#l=!1,this.#y+=1}#x(){return!1===this.#l}#v(){this.#l=!0,this.#d.restart()}draw(){this.#f(),this.#b(),this.#C(),this.#z(),this.#L()}#f(){this.setPrint("left","bold 46px Arial")}#b(){this.print(this.#p,this.#h-80,60,"green")}#C(){this.print("-",this.#h,60,"white")}#z(){this.print(this.#y,this.#h+65,60,"blue")}#L(){this.setPrint("left","normal 12px Arial")}reset(){this.#d.clearStart(),this.#l=!0,this.#p=0,this.#y=0}}class b{draw(t,i){t.fillStyle="green",t.fillRect(i.position.x-i.size.x/2,i.position.y-i.size.y/2,i.size.x,i.size.y)}}class C{draw(t,i){t.fillStyle="blue",t.fillRect(i.position.x-i.size.x/2,i.position.y-i.size.y/2,i.size.x,i.size.y)}}class z{#P;#S;#I;#R;constructor(){this.#P=new n,this.#R=new n}set position(t){this.#P.x=t.x,this.#P.y=t.y}set radius(t){this.#I=t}get#T(){return this.#S*(Math.PI/180)}get direction(){return this.#R}get position(){return this.#P}rotatePolar(t){this.#S=t,this.#R.x=this.#P.x+this.#I*Math.cos(this.#T),this.#R.y=this.#P.y+this.#I*Math.sin(this.#T)}rotate(t){this.#S=t;const i=new n(this.#R.x-this.#P.x,this.#R.y-this.#P.y),s=i.x,e=i.y,o=Math.cos(this.#T),r=Math.sin(this.#T),a=new n(s*o-e*r,s*r+e*o);this.#R.x=a.x+this.#P.x,this.#R.y=a.y+this.#P.y}draw(t){t.strokeStyle="orange",t.lineWidth=2,t.beginPath(),t.moveTo(this.#P.x,this.#P.y),t.lineTo(this.#R.x,this.#R.y),t.stroke()}#k(){this.rotatePolar(0),0===this.#E(0,1)?this.rotate(this.#E(-30,-5)):this.rotate(this.#E(5,30))}#B(){this.rotatePolar(0),0===this.#E(0,1)?this.rotate(this.#E(-150,-175)):this.rotate(this.#E(-185,-210))}getBallDir(){0===this.#E(0,1)?this.#k():this.#B()}#E(t,i){return Math.floor(Math.random()*(i-t+1)+t)}}class L{constructor(t,i,s){this.renders=t,this.printer=i,this.textPos=s}draw(t,i){this.renders.forEach((s=>{s.draw(t,i)}))}}class P{setPrint(t,i,s){t.textAlign=i,t.font=s}print(t,i,s,e,n){t.fillStyle=n,t.fillText(i,s,e)}printInLines(t,i,s,e,n,o){let r=o;i.forEach((i=>{this.print(t,i,n,r,s),r+=e}))}}class S extends P{draw(t,i){const s=i.getInfo();for(let e=0;e<s.length;e++)this.print(t,`${s[e].join("   ")}`,i.textPos.x,i.textPos.y+40*e+40,i.infoColor)}}class I{constructor(t){this.input=t}handleInput(t){this.input.movingUp?t.speed.y=1:this.input.movingDown?t.speed.y=-1:this.input.still&&(t.speed.y=0)}}class R{#$;#F;#D;#_;#G;#A;#M;#O;#U;get coords(){return this.#G}get movingUp(){return this.#$}get movingDown(){return this.#F}get still(){return this.#D}constructor(t,i=!1,s=null){this.#M=i,this.#A=t,document.addEventListener("mousemove",this.#H.bind(this),!1),this.#_=new n,this.#G=new n,this.#$=!1,this.#F=!1,this.#D=!0,this.#U=s}#H(t){clearTimeout(this.#O),this.#G.x=t.screenX,this.#G.y=t.screenY,this.#_.y-this.#G.y>=1?(this.#$=!0,this.#F=!1,this.#D=!1):this.#_.y-this.#G.y<=-1&&(this.#$=!1,this.#F=!0,this.#D=!1),this.#_.y=this.#G.y,this.#O=setTimeout(this.#q.bind(this),0)}#q(){this.#$=!1,this.#F=!1,this.#D=!0}draw(){!1!==this.#M&&this.#V()}#f(){this.#A.setPrint("left","bold 26px Arial")}#V(){this.#A.print(`Mouse: (${this.#G.x}, ${this.#G.y}), (up, down, still) - (${this.#$}, ${this.#F}, ${this.#D})`,this.#U.x,this.#U.y,"white")}#L(){this.#A.setPrint("left","normal 12px Arial")}}class T{#X;#c;#Y;#N;constructor(t,i){this.#X=t,this.#c=i}get canvasId(){return this.#X}get size(){return this.#c}get canvas(){return this.#Y}get ctx(){return this.#N}setCanvas(){this.#Y=document.getElementById(this.#X),this.#Y.width=this.#c.x,this.#Y.height=this.#c.y,this.#N=this.#Y.getContext("2d")}}const k="hide",E="select-controls-player",B="menu-container",$="btn-start",F="btn-reset",D="btn-overlay";const _=document.querySelector(".box"),G=document.getElementById("x"),A=document.getElementById("y"),M=document.getElementById("btn-overlay"),O=document.getElementById("overlay");function U(t){G.innerText=t.pageX,A.innerText=t.pageY}_.addEventListener("mousemove",U,!1),_.addEventListener("mouseenter",U,!1),_.addEventListener("mouseleave",U,!1),M.addEventListener("click",(function(){document.getElementById("overlay").style.display="block"}),!1),O.addEventListener("click",(function(){document.getElementById("overlay").style.display="none"}),!1);(new class{#j;#W;#Z;#J;#K;#Q;#tt;static get hide(){return k}static get selectGame(){return"select-controls-game"}static get selectPlayer(){return E}static get menuContainer(){return B}static get btnStart(){return $}static get btnReset(){return F}static get btnOverlay(){return D}constructor(t){this.#tt=t,this.#j=document.getElementById(B),this.#W=document.getElementById("menu-btns"),this.#Z=document.getElementById($),this.#J=document.getElementById(F),this.#K=document.getElementById(D),this.#it(),this.#Q=document.getElementById("select-controls-container")}#it(){HTMLSelectElement.prototype.__defineGetter__("val",(function(){return this.options[this.selectedIndex].value})),HTMLSelectElement.prototype.__defineGetter__("text",(function(){return this.options[this.selectedIndex].text}))}setPlayerView(t){this.#tt(this.#Q.childNodes[3].val),this.#Z.classList.add(k),this.#J.classList.add(k),this.#K.classList.add(k),this.#Q.classList.add(E),this.#st(t)}setGameView(){this.#j.classList.remove(k),this.#W.classList.remove(k),this.#Z.classList.remove(k),this.#J.classList.remove(k),this.#K.classList.remove(k)}hide(){this.#Z.classList.add(k),this.#J.classList.add(k),this.#K.classList.add(k),this.#Q.classList.add(k)}#st(){this.#Q.addEventListener("change",(t=>{this.#tt(t.target.value)}))}}).setGameView();const H=new class extends h{#M;constructor(t,i=!0){super(t),this.#M=i,this.views=t.views,this.infoCanvas=this.views.get("info"),this.gameCanvas=this.views.get("game"),this.pointsCanvas=this.views.get("points")}draw(){this._clearCtx(),null!=this.ball&&this.ball.draw(this.gameCanvas.ctx),null!=this.player1&&this.player1.draw(this.gameCanvas.ctx),null!=this.player2&&this.player2.draw(this.gameCanvas.ctx),null!=this.collisionLeftRender&&this.collisionLeftRender.draw(),null!=this.collisionRightRender&&this.collisionRightRender.draw(),this.collisionLeft?.draw(),this.collisionRight?.draw(),this.pointCount?.draw(),this._drawPoints(this.gameCanvas.ctx),this.ball instanceof a&&this.ball?.drawText(this.infoCanvas.ctx),this.input?.draw&&this.input?.draw(),this.#M&&this._print()}getInfo(){return[[`${this.name} - game-canvas (${this.gameCanvas.size.x}, ${this.gameCanvas.size.y}), info-canvas (${this.infoCanvas.size.x}, ${this.infoCanvas.size.y}), points-canvas (${this.pointsCanvas.size.x}, ${this.pointsCanvas.size.y})`]]}_clearCtx(){this.gameCanvas.ctx.clearRect(0,0,this.gameCanvas.size.x,this.gameCanvas.size.y),this.infoCanvas.ctx.clearRect(0,0,this.infoCanvas.size.x,this.infoCanvas.size.y),this.pointsCanvas.ctx.clearRect(0,0,this.pointsCanvas.size.x,this.pointsCanvas.size.y)}}(new class{constructor(t){this.views=t,this.infoCanvas=t.get("info"),this.gameCanvas=t.get("game"),this.timer=new l,this.printer=new v(this.infoCanvas.ctx),this.input=new d,this.mouseInput=new R(this.printer),this.bearing=new z,this.renderers={graphics:new L([new g]),text:new L([new S])},this.ball=new p(this.gameCanvas.size,new n(this.gameCanvas.size.x/2,this.gameCanvas.size.y/2),new n(10,10),new n(0,0),new c,this.renderers,this.printer,new n(5,5),new u,this.bearing),this.player1=new m(this.gameCanvas.size,new n(10,this.gameCanvas.size.y/2),new n(10,100),new n(0,0),new w(this.input),new b,this.printer,new n(5,30),"Green"),this.player2=new m(this.gameCanvas.size,new n(this.gameCanvas.size.x-10,this.gameCanvas.size.y/2),new n(10,100),new n(0,0),new I(this.mouseInput),new C,this.printer,new n(5,55),"Blue"),this.collisionLeft=new x,this.collisionRight=new x,this.pointCount=new f(this.views,this.ball)}}(new class{#et;#nt;constructor(){this.#et="laptop",this.#nt=new Map,this.#ot()}#ot(){this.#rt("laptop-game",new T("game-canvas",new n(800,600))),this.#rt("laptop-info",new T("info-canvas",new n(650,500))),this.#rt("laptop-points",new T("points-canvas",new n(800,90))),this.#rt("phone-game",new T("game-canvas",new n(300,300))),this.#rt("phone-info",new T("info-canvas",new n(500,500))),this.#rt("phone-points",new T("points-canvas",new n(300,90))),this.get("game").setCanvas(),this.get("info").setCanvas(),this.get("points").setCanvas()}#rt(t,i){this.#nt.set(t,i)}get(t){return this.#nt.get(`${this.#et}-${t}`)}}));document.getElementById("btn-start").addEventListener("click",(function(){H.ball.start()}),!1);document.getElementById("btn-reset").addEventListener("click",(function(){H.player1.reset(),H.player2.reset(),H.ball.reset(),H.pointCount.reset()}),!1),function t(i){H.update(i),H.draw(),requestAnimationFrame(t)}(0);
//# sourceMappingURL=pong.dc5fd56a.js.map
